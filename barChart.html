<!DOCTYPE html>
<html lang="en">

<head>
    <title>Area Chart</title>

    <link href="https://api.mapbox.com/mapbox-assembly/v0.24.0/assembly.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Gotu|Roboto&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Gotu', 'Roboto', sans-serif;
            color: #7E7E7E;
            display: flex;
            margin-left: 16px;
        }

        #wrapper {
            position: relative;
        }

        .bar {
            fill: #3BADCC;
        }

        .bar:hover {
            stroke: #e31a1c;
            stroke-width: 1.5px;

        }
    </style>
</head>

<body>
    <div class="wrapper" id="wrapper"></div>


    <script src="https://d3js.org/d3.v5.js"></script>
    <script async defer src="https://api.mapbox.com/mapbox-assembly/v0.24.0/assembly.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

    <script>
        // set the dimensions and margins of the graph
        var margin = {
                top: 15,
                right: 15,
                bottom: 40,
                left: 70
            },
            width = 220 - margin.left - margin.right,
            height = 160 - margin.top - margin.bottom;

        // set the ranges
        var x = d3.scaleBand()
            .range([0, width])
            .padding(0.2);
        var y = d3.scaleLinear()
            .range([height, 0])
            .nice();

        var svg = d3.select("#wrapper")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + margin.left + "," + margin.top + ")");

        var g = svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


        d3.csv("data/area-grinnell.csv").then(function (data) {

            // alphabetize by year
            data.sort(function (a, b) {
                return a.Year - b.Year
            });

            // format the data
            data.forEach(function (d) {
                d.area = +d.AREA
            });

            // scale the range of the data in the domains
            x.domain(data.map(function (d) {
                return d.Year;
            }));
            y.domain([0, d3.max(data, function (d) {
                return d.area;
            })]);

            // add bars
            svg.selectAll(".bar")
                .data(data)
                .enter().append("rect")
                .attr("class", "bar")
                .attr("x", function (d) {
                    return x(d.Year);
                })
                .attr("width", x.bandwidth())

                // no bars on window load
                .attr("height", function (d) {
                    return height - y(0);
                }) // bars equal to 0
                .attr("y", function (d) {
                    return y(0);
                })

            // add x-axis
            svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x));

            // add y-axis
            const yAxis = svg.append("g")
                .call(d3.axisLeft(y).ticks(5));

            // label y-axis
            const yAxisLabel = yAxis.append("text")
                .attr("class", "y-axis-label")
                .attr("fill", "#7E7E7E")
                .attr("transform", "rotate(-90)")
                .attr("x", -margin.top - 30)
                .attr("y", -margin.left + 12)
                .attr("text-anchor", "middle")
                .html("Area m&sup2;");

            // animate bars
            svg.selectAll("rect")
                .transition()
                .duration(800)
                .attr("y", function(d) { return y(d.area); })
                .attr("height", function(d) { return height - y(d.area); })
                .delay(function (d, i) {
                    return (i * 100)
                })

            // tooltips




        });
    </script>
</body>

</html>